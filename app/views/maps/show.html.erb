<div class="search-bar", data-controller="map"
     data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
     data-map-segments-coordinates-value="<%= @segments_coordinates.to_json %>"
     data-map-show-search-value="true"
     data-map-show-draw-tool-value="true"
     data-map-import-draw-url-value="<%= map_import_drawing_path(@map) %>"
     data-map-id-value="<%= @map.id %>"
     data-map-destroy-url-value="<%= explored_point_of_interests_path %>"
     data-map-create-url-value="<%= explored_point_of_interests_path %>"
     data-map-pois-value="<%= @pois.to_json %>">
  <%= turbo_frame_tag :mapcontainer do %>
  <div id="map-container" style="width: 100%; height: 85vh;" data-map-target="container">
  </div>
  <div id="markerOptionsModal" class="modal" style="display: none;">
    <div class="modal-content">
      <button id="editMarkerBtn">Edit Marker</button>
      <button id="deleteMarkerBtn">Delete Marker</button>
      <button id="cancelModalBtn">Cancel</button>
    </div>
  </div>
  <div>
    <button type="button" class="btn btn-flat" data-map-target="saveMatched" data-action="click->map#saveMatched">
      Save data (matched)
    </button>
    <button type="button" class="btn btn-flat" data-map-target="saveFreeform" data-action="click->map#saveFreeform">
      Save data (freeform)
    </button>
    <button type="button" class="btn btn-flat" data-bs-toggle="modal" data-bs-target="#createSegmentModal">
      Import data
    </button>
  <div>
  <% end %>
  <div class="modal fade" id="createSegmentModal" tabindex="-1" aria-labelledby="createSegmentModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="createSegmentModalLabel">Import data</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <%= simple_form_for([@map, @segment], url: map_import_track_path(@map), data: {action: "submit->map#loading"}) do |f| %>
            <%= f.input :gpx, as: :file, input_html: { class: "form-control" }, label_html: { class: "form-label" } %>
            <%= f.input :mode, as: :radio_buttons,
                        collection: [['matched', 'matched'], ['freeform', 'freeform']],
                        checked: 'matched',
                        legend_tag: false %>
            <%= f.button :submit, 'Upload', class: 'btn btn-flat' %>
          <% end %>
        </div>
        <div id="loading" class="modal-footer d-none" data-map-target="loading">
          <div><p>Processing the file...</p></div>
          <div><%= image_tag "loadingcat.gif", alt: "loading animation", style: "width: 100px; height: 100px;" %></div>
        </div>
      </div>
    </div>
  </div>
</div>
