<div data-controller="map"
     data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
     data-map-segments-coordinates-value="<%= @segments_coordinates.to_json %>"
     data-map-show-search-value="true">
  <div id="map-container" style="width: 100%; height: 85vh;" data-map-target="container">
  </div>
  <div>
    <button type="button" class="btn btn-flat" data-bs-toggle="modal" data-bs-target="#createSegmentModal">
      Import data
    </button>
    <div class="modal fade" id="createSegmentModal" tabindex="-1" aria-labelledby="createSegmentModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createSegmentModalLabel">Import data</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <%= simple_form_for([@map, @segment], url: map_import_path(@map), data: {action: "submit->map#loading"}) do |f| %>
              <%= f.input :gpx, as: :file, input_html: { class: "form-control" }, label_html: { class: "form-label" } %>
              <%= f.button :submit, 'Upload', class: 'btn btn-flat' %>
            <% end %>
          </div>
          <div id="loading" class="modal-footer d-none" data-map-target="loading">
            <div><p>Processing the file...</p></div>
            <div><%= image_tag "loadingcat.gif", alt: "loading animation", style: "width: 100px; height: 100px;" %></div>
          </div>
        </div>
      </div>
    </div>
  <div>
</div>
